!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=15)}({0:function(e){e.exports=[{cx:833.5,cy:399.5},{cx:609.5,cy:316.5},{cx:385.5,cy:407.5},{cx:854.5,cy:568.5},{cx:462.5,cy:582.5},{cx:651.5,cy:610.5},{cx:826.5,cy:757.5},{cx:233.5,cy:399.5},{cx:609.5,cy:316.5},{cx:385.5,cy:407.5},{cx:354.5,cy:568.5},{cx:462.5,cy:582.5},{cx:651.5,cy:610.5},{cx:826.5,cy:757.5}]},1:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},15:function(e,t,n){"use strict";n.r(t);var r=n(4),o=n.n(r),a={android:function(){return navigator.userAgent.match(/Android/i)},blackberry:function(){return navigator.userAgent.match(/BlackBerry/i)},ios:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},opera:function(){return navigator.userAgent.match(/Opera Mini/i)},windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return a.android()||a.blackberry()||a.ios()||a.opera()||a.windows()}},i=a,c=n(2),s=n.n(c),l=n(0),u=d3.selectAll("section"),d=d3.select("#chart"),f=d.select("svg"),p=f.select("g"),h=p.select(".g-map"),m=p.select(".g-nodes"),v=d3.select(".intro__dots"),g=d.select(".chart__tweets"),y={section:u,chart:d,svg:f,g:p,map:h,nodes:m,introDots:v,chartTweets:g,exploreNav:d3.select(".explore__nav"),header:d3.select("header")},x=16;var b={create:function(e){var t=e.data,n=e.x,r=e.y,o=e.fade,a=e.offset,i=y.chartTweets.append("div.tweet"),c=t.name,s=t.handle,l=t.text,u=t.time;i.append("p.tweet__name").text(c),i.append("p.tweet__handle").text(s),i.append("p.tweet__text").text(l),i.append("p.tweet__time").text(u),i.st({top:r,left:n}).st("opacity",0).transition().duration(o?500:0).st("opacity",1);var d=+i.node().offsetWidth/2,f=+i.node().offsetHeight/2,p=y.chartTweets.node().offsetWidth,h=y.chartTweets.node().offsetHeight,m=0,v=a?1.25*-f:0;n+d>=p-x&&(m=-d),n-d<=x&&(m=d),r+f>=h-x&&(v+=-f),r-f<=x&&(v=f),i.st({marginLeft:m,marginTop:v})},clear:function(){y.chartTweets.selectAll(".tweet").remove()}},w=[],_=1280,A=1024,M=2.5,j=5,P=null,k=null,O=[],T=d3.select("#intro"),E=T.select(".top"),S=T.select(".intro__hed"),z=T.selectAll(".intro__hed-text"),H=(T.selectAll(".intro__steps"),T.selectAll(".step")),W={name:"The Pudding",handle:"@puddingviz",text:"We ❤️ Carmen Sandiego",time:"11/14/18 12:39 PM"};function L(){y.nodes.selectAll(".node__example").transition().duration(200).delay(function(e,t){return 4e3*t}).st("opacity",1),O=d3.range(3).map(function(e){var t=l[e+j].cx*P/_,n=l[e+j].cy*k/A;return setTimeout(function(){return b.create({data:W,x:t,y:n,fade:!0,offset:!0})},4e3*e)})}function F(){P=E.node().offsetWidth,k=E.node().offsetHeight;var e=window.innerHeight,t=H.size();H.st("height",function(n,r){return e*(r===t-1?2:1)}).classed("is-visible",!0),M=M*P/_,y.svg.st("width",P).st("height",k),y.nodes.selectAll(".node, .node__example").translate(function(e){return[e.x*P/_,e.y*k/A]}),y.nodes.selectAll(".inner, .node__example").at("r",M).at("cx",0).at("cy",0),y.nodes.selectAll(".mid").at("r",4*M).at("cx",0).at("cy",0),y.nodes.selectAll(".outer").at("r",10*M).at("cx",0).at("cy",0),y.chartTweets.st("width",P).st("height",k)}var C={init:function(e){w=e,function(){var e=w.filter(function(e){return e.chosen}),t=y.nodes.selectAll(".node").data(e,function(e){return e.category});console.log({data:e});var n=t.enter().append("g").at("class",function(e){return"node node-".concat(e.category)});n.each(function(e,t,n){e.chosen&&(d3.select(n[t]).append("circle.outer"),d3.select(n[t]).append("circle.mid"))}),n.append("circle.inner");var r=w.filter(function(e){return e.example});y.nodes.selectAll(".node__example").data(r).enter().append("circle.node__example").st("opacity",0)}(),F()},resize:F,enter:function(e){var t;E.classed("is-active","title"!==e),"title"!==e&&(t=T.select(".intro__hed").node().offsetWidth,S.classed("is-hidden",!0),z.transition().duration(500).delay(function(e,t){return 50*t}).translate([-t,0]),T.select(".carmen-crouch").transition().duration(500).translate([-t,20])),"examples"!==e&&(b.clear(),O.forEach(function(e){return clearTimeout(e)})),"examples"===e&&L(),y.nodes.selectAll(".node").classed("is-active","categories"===e),y.nodes.selectAll(".node__example").classed("is-active","examples"===e)},exit:function(e){E.classed("is-active","examples"!==e),"examples"===e&&(S.classed("is-hidden",!1),T.select(".carmen-crouch").transition().duration(500).translate([0,20]),z.transition().duration(500).delay(function(e,t){return 50*t}).translate([0,0])),"examples"===e&&b.clear(),"categories"===e&&L(),y.nodes.selectAll(".node").classed("is-active","categories"===e),y.nodes.selectAll(".node__example").classed("is-active","categories"===e)},handoff:function(e){}},D=function(e){return e},N=function(e){if(null==e)return D;var t,n,r=e.scale[0],o=e.scale[1],a=e.translate[0],i=e.translate[1];return function(e,c){c||(t=n=0);var s=2,l=e.length,u=new Array(l);for(u[0]=(t+=e[0])*r+a,u[1]=(n+=e[1])*o+i;s<l;)u[s]=e[s],++s;return u}},q=function(e,t){for(var n,r=e.length,o=r-t;o<--r;)n=e[o],e[o++]=e[r],e[r]=n},B=function(e,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return G(e,t)})}:G(e,t)};function G(e,t){var n=t.id,r=t.bbox,o=null==t.properties?{}:t.properties,a=R(e,t);return null==n&&null==r?{type:"Feature",properties:o,geometry:a}:null==r?{type:"Feature",id:n,properties:o,geometry:a}:{type:"Feature",id:n,bbox:r,properties:o,geometry:a}}function R(e,t){var n=N(e.transform),r=e.arcs;function o(e,t){t.length&&t.pop();for(var o=r[e<0?~e:e],a=0,i=o.length;a<i;++a)t.push(n(o[a],a));e<0&&q(t,i)}function a(e){return n(e)}function i(e){for(var t=[],n=0,r=e.length;n<r;++n)o(e[n],t);return t.length<2&&t.push(t[0]),t}function c(e){for(var t=i(e);t.length<4;)t.push(t[0]);return t}function s(e){return e.map(c)}return function e(t){var n,r=t.type;switch(r){case"GeometryCollection":return{type:r,geometries:t.geometries.map(e)};case"Point":n=a(t.coordinates);break;case"MultiPoint":n=t.coordinates.map(a);break;case"LineString":n=i(t.arcs);break;case"MultiLineString":n=t.arcs.map(i);break;case"Polygon":n=s(t.arcs);break;case"MultiPolygon":n=t.arcs.map(s);break;default:return null}return{type:r,coordinates:n}}(t)}var $=function(e,t){var n={},r={},o={},a=[],i=-1;function c(e,t){for(var r in e){var o=e[r];delete t[o.start],delete o.start,delete o.end,o.forEach(function(e){n[e<0?~e:e]=1}),a.push(o)}}return t.forEach(function(n,r){var o,a=e.arcs[n<0?~n:n];a.length<3&&!a[1][0]&&!a[1][1]&&(o=t[++i],t[i]=n,t[r]=o)}),t.forEach(function(t){var n,a,i=function(t){var n,r=e.arcs[t<0?~t:t],o=r[0];e.transform?(n=[0,0],r.forEach(function(e){n[0]+=e[0],n[1]+=e[1]})):n=r[r.length-1];return t<0?[n,o]:[o,n]}(t),c=i[0],s=i[1];if(n=o[c])if(delete o[n.end],n.push(t),n.end=s,a=r[s]){delete r[a.start];var l=a===n?n:n.concat(a);r[l.start=n.start]=o[l.end=a.end]=l}else r[n.start]=o[n.end]=n;else if(n=r[s])if(delete r[n.start],n.unshift(t),n.start=c,a=o[c]){delete o[a.end];var u=a===n?n:a.concat(n);r[u.start=a.start]=o[u.end=n.end]=u}else r[n.start]=o[n.end]=n;else r[(n=[t]).start=c]=o[n.end=s]=n}),c(o,r),c(r,o),t.forEach(function(e){n[e<0?~e:e]||a.push([e])}),a},I=function(e){return R(e,function(e,t,n){var r,o,a;if(arguments.length>1)r=function(e,t,n){var r,o=[],a=[];function i(e){var t=e<0?~e:e;(a[t]||(a[t]=[])).push({i:e,g:r})}function c(e){e.forEach(i)}function s(e){e.forEach(c)}return function e(t){switch(r=t,t.type){case"GeometryCollection":t.geometries.forEach(e);break;case"LineString":c(t.arcs);break;case"MultiLineString":case"Polygon":s(t.arcs);break;case"MultiPolygon":t.arcs.forEach(s)}}(t),a.forEach(null==n?function(e){o.push(e[0].i)}:function(e){n(e[0].g,e[e.length-1].g)&&o.push(e[0].i)}),o}(0,t,n);else for(o=0,r=new Array(a=e.arcs.length);o<a;++o)r[o]=o;return{type:"MultiLineString",arcs:$(e,r)}}.apply(this,arguments))};var U=new ArrayBuffer(16);new Float64Array(U),new Uint32Array(U);Math.PI,Math.abs,Math.atan2,Math.cos,Math.sin;var X=d3.select("#map").selectAll(".step"),Y=null,J=null,K=null,Q=null,V=null,Z=null,ee=null,te=null,ne=!1,re=[];function oe(){var e=window.innerHeight,t=X.size();if(X.st("height",function(n,r){return e*(r===t-1?2:1)}),ne){var n=y.chart.node().offsetHeight,r=y.chart.node().offsetWidth,o=n/2.5;ee.translate([r/2,n/2]).scale(o).clipAngle(90),Y.at("cx",r/2).at("cy",n/2).at("r",ee.scale()),J.at("d",te({type:"Sphere"})),Q.at("d",te),V.at("d",te),Z.at("d",te),K.at("d",te),y.map.translate([0,0])}}var ae={init:function(e){re=e,d3.loadData("assets/data/world-110m.json",function(e,t){e&&console.log(e),function(e){ee=d3.geoOrthographic(),te=d3.geoPath().projection(ee);var t=B(e,e.objects.countries).features,n=B(e,e.objects.land),r=I(e,e.objects.countries,function(e,t){return e!==t});J=y.map.append("path.sphere"),Q=y.map.append("path.graticule"),Z=y.map.append("path.land"),(V=y.map.append("path.border")).datum(r),Z.datum(n),K=y.map.selectAll(".country").data(t).enter().append("path.country"),Y=y.map.append("circle.outline");var o=d3.geoGraticule();Q.datum(o)}(t[0]),ne=!0,oe()})},resize:oe,handoff:function(e){var t=re.filter(function(e){return e.chosen}),n=y.nodes.selectAll(".node").data(t,function(e){return e.category}),r=n.enter().append("g").at("class",function(e){return"node node-".concat(e.category)});r.each(function(e,t,n){e.chosen&&(d3.select(n[t]).append("circle.outer"),d3.select(n[t]).append("circle.mid"))}),r.append("circle.inner"),n.exit().remove(),r.merge(n).transition().duration(500).translate(function(e){return[500*Math.random(),500*Math.random()]})}},ie={name:"The Pudding",handle:"@puddingviz",text:"We ❤️ Carmen Sandiego",time:"11/14/18 12:39 PM"},ce=d3.select("#curate"),se=ce.select("nav"),le=(ce.select("p"),[]),ue=[],de=0,fe=0,pe=0,he=d3.scaleLinear();function me(e){var t=e.x,n=e.y;b.clear(),b.create({data:ie,x:t,y:n,offset:!0}),y.nodes.selectAll(".node").classed("is-highlight",!1),d3.select(this).classed("is-highlight",!0)}function ve(){}function ge(){se.selectAll("input").prop("checked",!1);var e=d3.select(this);e.prop("checked",!0),function(e){ue=le.filter(function(t){return t.category===e});var t=d3.max(ue,function(e){return e.followers});he.domain([0,t]).range([.1,.33]);var n=y.nodes.selectAll(".node").data(ue,function(e){return e.id}),r=n.enter().append("g").at("class",function(e){return"node node-".concat(e.category," is-active")}).on("mouseenter",me).on("mouseout",ve);r.each(function(e,t,n){e.chosen&&(d3.select(n[t]).append("circle.outer"),d3.select(n[t]).append("circle.mid"))}),r.append("circle.inner").at({cx:0,cy:0,r:0}),n.exit().remove(),r.merge(n).classed("is-curate",!0).select(".inner").transition().duration(500).at("r",pe),o=1.5*-pe,d3.forceSimulation(ue).on("tick",ye).alphaDecay(.1).alphaMin(.001).alphaTarget(.2).velocityDecay(.4).force("center",d3.forceCenter(de,fe)).force("x",d3.forceX(de)).force("y",d3.forceY(fe)).force("charge",d3.forceManyBody().strength(o));var o}(e.parent().select("input").at("value"))}function ye(){y.nodes.selectAll(".node").translate(function(e){return[e.x,e.y]})}function xe(){de=y.chart.node().offsetWidth/2,fe=y.chart.node().offsetHeight/2,se.st("margin-bottom",window.innerHeight),pe=8}var be={init:function(e){le=e,se.selectAll("label").on("click",ge),xe()},resize:xe,handoff:function(e){ge.call(se.select("label").node())}},we=1280,_e=2.5,Ae=d3.select("#explore"),Me=Ae.select(".explore__dots");function je(){var e=Ae.node().offsetWidth;_e=Math.ceil(_e*e/we);var t=Math.floor(13e4/e),n=Math.floor(13e4/t);Me.st({height:n*_e,backgroundSize:"".concat(4*_e,"px ").concat(4*_e,"px")})}var Pe={init:function(){je()},resize:je,handoff:function(e){}};function ke(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Oe(){var e=y.header.node().offsetHeight,t=window.innerHeight-e;y.chart.st({height:t}),C.resize(),ae.resize(),be.resize(),Pe.resize()}function Te(e){var t=d3.select(e).at("data-step");C.enter(t)}function Ee(e){var t=d3.select(e).at("data-step");C.exit(t)}function Se(e){var t=y.section.filter(function(t,n){return n===e}).at("id");switch(console.log("section",t),y.chart.classed("is-hidden",!1),y.introDots.classed("is-hidden",!0),y.exploreNav.classed("is-hidden",!0),y.map.classed("is-hidden",!0),t){case"intro":y.introDots.classed("is-hidden",!1),C.handoff();break;case"map":ae.handoff(),y.map.classed("is-hidden",!1);break;case"curate":be.handoff();break;case"explore":y.chart.classed("is-hidden",!0),y.exploreNav.classed("is-hidden",!1),Pe.handoff()}}function ze(e){}function He(e){}function We(e){C.init(e),ae.init(e),be.init(e),Pe.init(e),s()({selector:"section",enter:function(e){Se(+d3.select(e).attr("data-index"))},exit:function(e){var t=+d3.select(e).attr("data-index");Se(t=Math.max(0,t-1))},offset:.2}),s()({selector:"#intro .step",enter:Te,exit:Ee,offset:.9}),s()({selector:"#map .step",enter:ze,exit:He,offset:.9}),Oe()}function Le(){return new Promise(function(e){var t="abcde";e(d3.range(2400).map(function(e,n){return{text:"Testing text",category:t.charAt(n%t.length),followers:Math.floor(1e3*Math.random()),chosen:n<t.length,example:n>=t.length&&n<t.length+3}}).map(function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){ke(e,t,n[t])})}return e}({},e,{x:e.chosen||e.example?l[t].cx:Math.random()*window.innerWidth,y:e.chosen||e.example?l[t].cy:Math.random()*window.innerHeight})}))})}var Fe={init:function(){Le().then(We)},resize:Oe},Ce=d3.select("body"),De=0;function Ne(){var e=Ce.node().offsetWidth;De!==e&&(De=e,Fe.resize())}Ce.classed("is-mobile",i.any()),window.addEventListener("resize",o()(Ne,150)),function(){if(Ce.select("header").classed("is-sticky")){var e=Ce.select(".header__menu"),t=Ce.select(".header__toggle");t.on("click",function(){var n=e.classed("is-visible");e.classed("is-visible",!n),t.classed("is-visible",!n)})}}(),Fe.init()},2:function(e,t,n){"use strict";var r,o;void 0===(o="function"==typeof(r=function(){return function(e){function t(){h=!1;var e=function(){if(u&&"number"==typeof u){var e=Math.min(Math.max(0,u),1);return v-e*v}return v}();(m=m.filter(function(t){var n=t.getBoundingClientRect(),r=n.top,o=r<e;if(o&&!t.__enter_view){if(c(t),f)return!1}else!o&&t.__enter_view&&s&&s(t);return t.__enter_view=o,!0})).length||window.removeEventListener("scroll",n,!0)}function n(){h||(h=!0,p(t))}function r(){var e,n;e=document.documentElement.clientHeight,n=window.innerHeight||0,v=Math.max(e,n),t()}function o(e){for(var t=e.length,n=[],r=0;r<t;r+=1)n.push(e[r]);return n}function a(){m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;return"string"==typeof e?o(t.querySelectorAll(e)):e instanceof NodeList?o(e):e instanceof Array?e:void 0}(i)}var i=e.selector,c=e.enter,s=e.exit,l=e.offset,u=void 0===l?0:l,d=e.once,f=void 0!==d&&d,p=null,h=!1,m=[],v=0;i&&c||console.error("must set selector and enter options"),p=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){return setTimeout(e,1e3/60)},a(),window.addEventListener("resize",r,!0),window.addEventListener("scroll",n,!0),r(),t()}})?r.call(t,n,t,e):r)||(e.exports=o)},4:function(e,t,n){(function(t){var n="Expected a function",r=NaN,o="[object Symbol]",a=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,s=/^0o[0-7]+$/i,l=parseInt,u="object"==typeof t&&t&&t.Object===Object&&t,d="object"==typeof self&&self&&self.Object===Object&&self,f=u||d||Function("return this")(),p=Object.prototype.toString,h=Math.max,m=Math.min,v=function(){return f.Date.now()};function g(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function y(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&p.call(e)==o}(e))return r;if(g(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=g(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var n=c.test(e);return n||s.test(e)?l(e.slice(2),n?2:8):i.test(e)?r:+e}e.exports=function(e,t,r){var o,a,i,c,s,l,u=0,d=!1,f=!1,p=!0;if("function"!=typeof e)throw new TypeError(n);function x(t){var n=o,r=a;return o=a=void 0,u=t,c=e.apply(r,n)}function b(e){var n=e-l;return void 0===l||n>=t||n<0||f&&e-u>=i}function w(){var e=v();if(b(e))return _(e);s=setTimeout(w,function(e){var n=t-(e-l);return f?m(n,i-(e-u)):n}(e))}function _(e){return s=void 0,p&&o?x(e):(o=a=void 0,c)}function A(){var e=v(),n=b(e);if(o=arguments,a=this,l=e,n){if(void 0===s)return function(e){return u=e,s=setTimeout(w,t),d?x(e):c}(l);if(f)return s=setTimeout(w,t),x(l)}return void 0===s&&(s=setTimeout(w,t)),c}return t=y(t)||0,g(r)&&(d=!!r.leading,i=(f="maxWait"in r)?h(y(r.maxWait)||0,t):i,p="trailing"in r?!!r.trailing:p),A.cancel=function(){void 0!==s&&clearTimeout(s),u=0,o=l=a=s=void 0},A.flush=function(){return void 0===s?c:_(v())},A}}).call(this,n(1))}});